<title>Build Your Own vX!</title>
<h1>Build You Own vX!</h1>
<p>Customize your vX! Select the packages you want.</p>

<script type="text/javascript" src="lib/vx.all.js"></script>
<script type="text/javascript">
function $(e){return document.getElementById(e)}

var selmod = []
var modsrc = {};
var modules = {};
var nsc = "";
var altc = "_=_?_:{}\n";

_.X("lib/vx.js", function(e){
  nsc = e;
})

_.R(function(){
  _.X("modules.json",function(json){
    $("selectmodules").innerHTML="";
    modules = _.P(json);
    for(var x in modules){
      var mod = modules[x];
      $("selectmodules").innerHTML+='<input id="'+x+'" type=checkbox name='+x+'><label for='+x+' title='+mod.desc.replace(/\'/g,'\\\'')+'>'+mod.name+'</label><br>'
    }
    for(var x in modules){
      _.E($(x), "click", function(){
        checkmods();
      })
    }
  })
})


function checkmods(){
  for(var k in modules){
    if($(k).checked && selmod.indexOf(k) == -1){ //needs inArray functionality
      selmod.push(k);
      for(var y = 0; y < modules[k].dep.length; y++){
        $(modules[k].dep[y]).checked = true;
        checkmods();
      }
    }
    if($(k).checked == false && selmod.indexOf(k) != -1){
      selmod.splice(selmod.indexOf(k),1); //remove from array
    }
  }
  for(var i = 0; i < selmod.length; i++){
    if(!modsrc[selmod[i]]){
      loadmod(selmod[i]);
    }
  }
  rebuild();
}

function loadmod(mod){
  _.X("lib/vx."+mod+".js", function(e){
    modsrc[mod] = e;
    rebuild()
  })
}

function rebuild(){
  var code = $("ns").checked?nsc:"";
  for(var u = 0; u < selmod.length; u++){
    code+=modsrc[selmod[u]]+"\n";
  }
  code=(code.length>0)?(($("ns").checked?"":altc)+code):"/*No Modules Selected*/"
  $("build").value = code
  $("size").innerHTML = "Size: "+code.length+" bytes";
}


</script>
<input id="ns" type=checkbox name='ns' onclick="rebuild()"><label for='ns'>Namespaces</label>
<div id="selectmodules">Loading Module List...</div>
<br>
<span id="size">Size: 23 bytes</span><br>
<textarea id="build" style="width: 100%; height: 300px">
/*No Modules Selected*/
</textarea>
