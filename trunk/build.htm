<title>Build Your Own vX!</title>
<h1>Build You Own vX!</h1>
<p>Customize your vX! Select the packages you want.</p>

<script type="text/javascript" src="lib/vx.all.js"></script>
<script type="text/javascript">

var selmod = []
var modsrc = {};
var modules = {};
var nsc = "";
var altc = "var _=_?_:{}\n";

_.X("lib/vx.js", function(e){
  nsc = e+"\n";
})

_.R(function(){
  _.X("modules.json",function(json){
    _.G("selectmodules").innerHTML="";
    modules = _.S(json,true);
    for(var x in modules){
      var mod = modules[x];
      _.G("selectmodules").innerHTML+='<input id="'+x+'" type=checkbox name='+x+'><label for='+x+' title=\''+mod.desc.replace(/\'/g,'\\\'')+'\'>'+mod.name+'</label><br>'
    }
    for(var x in modules){
      _.E(_.G(x), "click", function(){
        checkmods();
      })
    }
  })
})


function checkmods(){
  for(var k in modules){
    if(_.G(k).checked && selmod.indexOf(k) == -1){ //needs inArray functionality
      selmod.push(k);
      for(var y = 0; y < modules[k].dep.length; y++){
        _.G(modules[k].dep[y]).checked = true;
        checkmods();
      }
    }
    if(_.G(k).checked == false && selmod.indexOf(k) != -1){
      selmod.splice(selmod.indexOf(k),1); //remove from array
    }
  }
  for(var i = 0; i < selmod.length; i++){
    if(!modsrc[selmod[i]]){
      loadmod(selmod[i]);
    }
  }
  rebuild();
}

function loadmod(mod){
  _.X("lib/vx."+mod+".js", function(e){
    modsrc[mod] = e;
    rebuild()
  })
}

function rebuild(){
  var code = _.G("ns").checked?nsc:"";
  for(var u = 0; u < selmod.length; u++){
    code+=modsrc[selmod[u]]+"\n";
  }
  code=(code.length>0)?((_.G("ns").checked?"":altc)+code):"/*No Modules Selected*/"
  _.G("build").value = code
  _.G("size").innerHTML = "Size: "+code.length+" bytes";
}


</script>
<input id="ns" type=checkbox name='ns' onclick="rebuild()"><label for='ns'>Namespaces</label>
<div id="selectmodules">Loading Module List...</div>
<br>
<span id="size">Size: 23 bytes</span><br>
<textarea id="build" style="width: 100%; height: 300px">
/*No Modules Selected*/
</textarea>
